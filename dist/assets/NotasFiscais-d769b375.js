import{r,$ as ur,_ as L,a0 as je,a1 as qt,a2 as fr,R as H,j as f,d as re,f as mr,g as vr,o as pr,s as hr,m as br,h as $r,i as gr,k as Er,l as xr,U as W,S as K,C as V,L as et,B as ft,E as G,F as yr,a3 as wr,G as Ue,H as gt,I as Et,K as Be,a4 as xt,M as Cr,J as Pr,A as Sr}from"./index-a996d77c.js";import{D as Vt,a as Yt,b as Xt,c as Gt,d as Zt,e as Nr}from"./dialog-143d4e79.js";import{S as Jt,a as Qt,b as en,c as tn,d as tt,e as _r,f as Rr}from"./select-c1f59cc1.js";import{c as nn,_ as rn,u as on,a as q,f as an,z as sn,s as cn,b as ln,R as dn,e as un,h as fn}from"./component-78adbb4d.js";import{S as mn}from"./search-9e1431e9.js";import{p as yt}from"./partesBoi-e27c0c05.js";import{T as vn}from"./trash-2-99337be2.js";import{P as pn}from"./plus-circle-b044468d.js";import{r as Dr,u as Fe,w as Or}from"./xlsx-81fdaaba.js";import{D as Ar}from"./download-e041ef9d.js";import{F as Fr}from"./file-spreadsheet-53adb39f.js";import{F as jr}from"./file-text-fee5fbf7.js";import{P as Tr}from"./pen-98cd02d5.js";import"./Combination-a26b2933.js";import"./check-81dc6077.js";function de(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function kr(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function hn(...e){return t=>e.forEach(n=>kr(n,t))}function Ee(...e){return r.useCallback(hn(...e),e)}function Lr(e,t=[]){let n=[];function o(c,i){const s=r.createContext(i),d=n.length;n=[...n,i];function u(v){const{scope:x,children:p,...g}=v,l=(x==null?void 0:x[e][d])||s,b=r.useMemo(()=>g,Object.values(g));return r.createElement(l.Provider,{value:b},p)}function h(v,x){const p=(x==null?void 0:x[e][d])||s,g=r.useContext(p);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${v}\` must be used within \`${c}\``)}return u.displayName=c+"Provider",[u,h]}const a=()=>{const c=n.map(i=>r.createContext(i));return function(s){const d=(s==null?void 0:s[e])||c;return r.useMemo(()=>({[`__scope${e}`]:{...s,[e]:d}}),[s,d])}};return a.scopeName=e,[o,Mr(a,...t)]}function Mr(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const o=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const i=o.reduce((s,{useScope:d,scopeName:u})=>{const v=d(c)[`__scope${u}`];return{...s,...v}},{});return r.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}const nt=globalThis!=null&&globalThis.document?r.useLayoutEffect:()=>{},Ir=ur["useId".toString()]||(()=>{});let Ur=0;function We(e){const[t,n]=r.useState(Ir());return nt(()=>{e||n(o=>o??String(Ur++))},[e]),e||(t?`radix-${t}`:"")}function ne(e){const t=r.useRef(e);return r.useEffect(()=>{t.current=e}),r.useMemo(()=>(...n)=>{var o;return(o=t.current)===null||o===void 0?void 0:o.call(t,...n)},[])}function Br({prop:e,defaultProp:t,onChange:n=()=>{}}){const[o,a]=Wr({defaultProp:t,onChange:n}),c=e!==void 0,i=c?e:o,s=ne(n),d=r.useCallback(u=>{if(c){const v=typeof u=="function"?u(e):u;v!==e&&s(v)}else a(u)},[c,e,a,s]);return[i,d]}function Wr({defaultProp:e,onChange:t}){const n=r.useState(e),[o]=n,a=r.useRef(o),c=ne(t);return r.useEffect(()=>{a.current!==o&&(c(o),a.current=o)},[o,a,c]),n}const mt=r.forwardRef((e,t)=>{const{children:n,...o}=e,a=r.Children.toArray(n),c=a.find(Hr);if(c){const i=c.props.children,s=a.map(d=>d===c?r.Children.count(i)>1?r.Children.only(null):r.isValidElement(i)?i.props.children:null:d);return r.createElement(rt,L({},o,{ref:t}),r.isValidElement(i)?r.cloneElement(i,void 0,s):null)}return r.createElement(rt,L({},o,{ref:t}),n)});mt.displayName="Slot";const rt=r.forwardRef((e,t)=>{const{children:n,...o}=e;return r.isValidElement(n)?r.cloneElement(n,{...Kr(o,n.props),ref:hn(t,n.ref)}):r.Children.count(n)>1?r.Children.only(null):null});rt.displayName="SlotClone";const zr=({children:e})=>r.createElement(r.Fragment,null,e);function Hr(e){return r.isValidElement(e)&&e.type===zr}function Kr(e,t){const n={...t};for(const o in t){const a=e[o],c=t[o];/^on[A-Z]/.test(o)?n[o]=(...s)=>{c==null||c(...s),a==null||a(...s)}:o==="style"?n[o]={...a,...c}:o==="className"&&(n[o]=[a,c].filter(Boolean).join(" "))}return{...e,...n}}const qr=["a","button","div","h2","h3","img","li","nav","ol","p","span","svg","ul"],Te=qr.reduce((e,t)=>{const n=r.forwardRef((o,a)=>{const{asChild:c,...i}=o,s=c?mt:t;return r.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),r.createElement(s,L({},i,{ref:a}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Vr(e,t){e&&je.flushSync(()=>e.dispatchEvent(t))}function Yr(e){const t=ne(e);r.useEffect(()=>{const n=o=>{o.key==="Escape"&&t(o)};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[t])}const ot="dismissableLayer.update",Xr="dismissableLayer.pointerDownOutside",Gr="dismissableLayer.focusOutside";let wt;const Zr=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Jr=r.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:c,onInteractOutside:i,onDismiss:s,...d}=e,u=r.useContext(Zr),[h,v]=r.useState(null),[,x]=r.useState({}),p=Ee(t,P=>v(P)),g=Array.from(u.layers),[l]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=g.indexOf(l),$=h?g.indexOf(h):-1,C=u.layersWithOutsidePointerEventsDisabled.size>0,y=$>=b,m=Qr(P=>{const S=P.target,R=[...u.branches].some(A=>A.contains(S));!y||R||(a==null||a(P),i==null||i(P),P.defaultPrevented||s==null||s())}),E=eo(P=>{const S=P.target;[...u.branches].some(A=>A.contains(S))||(c==null||c(P),i==null||i(P),P.defaultPrevented||s==null||s())});return Yr(P=>{$===u.layers.size-1&&(o==null||o(P),!P.defaultPrevented&&s&&(P.preventDefault(),s()))}),r.useEffect(()=>{if(h)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(wt=document.body.style.pointerEvents,document.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(h)),u.layers.add(h),Ct(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(document.body.style.pointerEvents=wt)}},[h,n,u]),r.useEffect(()=>()=>{h&&(u.layers.delete(h),u.layersWithOutsidePointerEventsDisabled.delete(h),Ct())},[h,u]),r.useEffect(()=>{const P=()=>x({});return document.addEventListener(ot,P),()=>document.removeEventListener(ot,P)},[]),r.createElement(Te.div,L({},d,{ref:p,style:{pointerEvents:C?y?"auto":"none":void 0,...e.style},onFocusCapture:de(e.onFocusCapture,E.onFocusCapture),onBlurCapture:de(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:de(e.onPointerDownCapture,m.onPointerDownCapture)}))});function Qr(e){const t=ne(e),n=r.useRef(!1),o=r.useRef(()=>{});return r.useEffect(()=>{const a=i=>{if(i.target&&!n.current){let d=function(){bn(Xr,t,s,{discrete:!0})};const s={originalEvent:i};i.pointerType==="touch"?(document.removeEventListener("click",o.current),o.current=d,document.addEventListener("click",o.current,{once:!0})):d()}n.current=!1},c=window.setTimeout(()=>{document.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(c),document.removeEventListener("pointerdown",a),document.removeEventListener("click",o.current)}},[t]),{onPointerDownCapture:()=>n.current=!0}}function eo(e){const t=ne(e),n=r.useRef(!1);return r.useEffect(()=>{const o=a=>{a.target&&!n.current&&bn(Gr,t,{originalEvent:a},{discrete:!1})};return document.addEventListener("focusin",o),()=>document.removeEventListener("focusin",o)},[t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Ct(){const e=new CustomEvent(ot);document.dispatchEvent(e)}function bn(e,t,n,{discrete:o}){const a=n.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),o?Vr(a,c):a.dispatchEvent(c)}const ze="focusScope.autoFocusOnMount",He="focusScope.autoFocusOnUnmount",Pt={bubbles:!1,cancelable:!0},to=r.forwardRef((e,t)=>{const{loop:n=!1,trapped:o=!1,onMountAutoFocus:a,onUnmountAutoFocus:c,...i}=e,[s,d]=r.useState(null),u=ne(a),h=ne(c),v=r.useRef(null),x=Ee(t,l=>d(l)),p=r.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;r.useEffect(()=>{if(o){let l=function($){if(p.paused||!s)return;const C=$.target;s.contains(C)?v.current=C:te(v.current,{select:!0})},b=function($){p.paused||!s||s.contains($.relatedTarget)||te(v.current,{select:!0})};return document.addEventListener("focusin",l),document.addEventListener("focusout",b),()=>{document.removeEventListener("focusin",l),document.removeEventListener("focusout",b)}}},[o,s,p.paused]),r.useEffect(()=>{if(s){Nt.add(p);const l=document.activeElement;if(!s.contains(l)){const $=new CustomEvent(ze,Pt);s.addEventListener(ze,u),s.dispatchEvent($),$.defaultPrevented||(no(co($n(s)),{select:!0}),document.activeElement===l&&te(s))}return()=>{s.removeEventListener(ze,u),setTimeout(()=>{const $=new CustomEvent(He,Pt);s.addEventListener(He,h),s.dispatchEvent($),$.defaultPrevented||te(l??document.body,{select:!0}),s.removeEventListener(He,h),Nt.remove(p)},0)}}},[s,u,h,p]);const g=r.useCallback(l=>{if(!n&&!o||p.paused)return;const b=l.key==="Tab"&&!l.altKey&&!l.ctrlKey&&!l.metaKey,$=document.activeElement;if(b&&$){const C=l.currentTarget,[y,m]=ro(C);y&&m?!l.shiftKey&&$===m?(l.preventDefault(),n&&te(y,{select:!0})):l.shiftKey&&$===y&&(l.preventDefault(),n&&te(m,{select:!0})):$===C&&l.preventDefault()}},[n,o,p.paused]);return r.createElement(Te.div,L({tabIndex:-1},i,{ref:x,onKeyDown:g}))});function no(e,{select:t=!1}={}){const n=document.activeElement;for(const o of e)if(te(o,{select:t}),document.activeElement!==n)return}function ro(e){const t=$n(e),n=St(t,e),o=St(t.reverse(),e);return[n,o]}function $n(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const a=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||a?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function St(e,t){for(const n of e)if(!oo(n,{upTo:t}))return n}function oo(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function ao(e){return e instanceof HTMLInputElement&&"select"in e}function te(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&ao(e)&&t&&e.select()}}const Nt=so();function so(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=_t(e,t),e.unshift(t)},remove(t){var n;e=_t(e,t),(n=e[0])===null||n===void 0||n.resume()}}}function _t(e,t){const n=[...e],o=n.indexOf(t);return o!==-1&&n.splice(o,1),n}function co(e){return e.filter(t=>t.tagName!=="A")}const io=r.forwardRef((e,t)=>{var n;const{container:o=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...a}=e;return o?qt.createPortal(r.createElement(Te.div,L({},a,{ref:t})),o):null});function lo(e,t){return r.useReducer((n,o)=>{const a=t[n][o];return a??n},e)}const ke=e=>{const{present:t,children:n}=e,o=uo(t),a=typeof n=="function"?n({present:o.isPresent}):r.Children.only(n),c=Ee(o.ref,a.ref);return typeof n=="function"||o.isPresent?r.cloneElement(a,{ref:c}):null};ke.displayName="Presence";function uo(e){const[t,n]=r.useState(),o=r.useRef({}),a=r.useRef(e),c=r.useRef("none"),i=e?"mounted":"unmounted",[s,d]=lo(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return r.useEffect(()=>{const u=Ne(o.current);c.current=s==="mounted"?u:"none"},[s]),nt(()=>{const u=o.current,h=a.current;if(h!==e){const x=c.current,p=Ne(u);e?d("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(h&&x!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,d]),nt(()=>{if(t){const u=v=>{const p=Ne(o.current).includes(v.animationName);v.target===t&&p&&je.flushSync(()=>d("ANIMATION_END"))},h=v=>{v.target===t&&(c.current=Ne(o.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",u),t.addEventListener("animationend",u),()=>{t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",u),t.removeEventListener("animationend",u)}}else d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:r.useCallback(u=>{u&&(o.current=getComputedStyle(u)),n(u)},[])}}function Ne(e){return(e==null?void 0:e.animationName)||"none"}let Ke=0;function fo(){r.useEffect(()=>{var e,t;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=n[0])!==null&&e!==void 0?e:Rt()),document.body.insertAdjacentElement("beforeend",(t=n[1])!==null&&t!==void 0?t:Rt()),Ke++,()=>{Ke===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(o=>o.remove()),Ke--}},[])}function Rt(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var gn=nn(),qe=function(){},Le=r.forwardRef(function(e,t){var n=r.useRef(null),o=r.useState({onScrollCapture:qe,onWheelCapture:qe,onTouchMoveCapture:qe}),a=o[0],c=o[1],i=e.forwardProps,s=e.children,d=e.className,u=e.removeScrollBar,h=e.enabled,v=e.shards,x=e.sideCar,p=e.noIsolation,g=e.inert,l=e.allowPinchZoom,b=e.as,$=b===void 0?"div":b,C=rn(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),y=x,m=on([n,t]),E=q(q({},C),a);return r.createElement(r.Fragment,null,h&&r.createElement(y,{sideCar:gn,removeScrollBar:u,shards:v,noIsolation:p,inert:g,setCallbacks:c,allowPinchZoom:!!l,lockRef:n}),i?r.cloneElement(r.Children.only(s),q(q({},E),{ref:m})):r.createElement($,q({},E,{className:d,ref:m}),s))});Le.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Le.classNames={fullWidth:an,zeroRight:sn};var at=!1;if(typeof window<"u")try{var _e=Object.defineProperty({},"passive",{get:function(){return at=!0,!0}});window.addEventListener("test",_e,_e),window.removeEventListener("test",_e,_e)}catch{at=!1}var ae=at?{passive:!1}:!1,mo=function(e){var t=window.getComputedStyle(e);return t.overflowY!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowY==="visible")},vo=function(e){var t=window.getComputedStyle(e);return t.overflowX!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowX==="visible")},Dt=function(e,t){var n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=En(e,n);if(o){var a=xn(e,n),c=a[1],i=a[2];if(c>i)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},po=function(e){var t=e.scrollTop,n=e.scrollHeight,o=e.clientHeight;return[t,n,o]},ho=function(e){var t=e.scrollLeft,n=e.scrollWidth,o=e.clientWidth;return[t,n,o]},En=function(e,t){return e==="v"?mo(t):vo(t)},xn=function(e,t){return e==="v"?po(t):ho(t)},bo=function(e,t){return e==="h"&&t==="rtl"?-1:1},$o=function(e,t,n,o,a){var c=bo(e,window.getComputedStyle(t).direction),i=c*o,s=n.target,d=t.contains(s),u=!1,h=i>0,v=0,x=0;do{var p=xn(e,s),g=p[0],l=p[1],b=p[2],$=l-b-c*g;(g||$)&&En(e,s)&&(v+=$,x+=g),s=s.parentNode}while(!d&&s!==document.body||d&&(t.contains(s)||t===s));return(h&&(a&&v===0||!a&&i>v)||!h&&(a&&x===0||!a&&-i>x))&&(u=!0),u},Re=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Ot=function(e){return[e.deltaX,e.deltaY]},At=function(e){return e&&"current"in e?e.current:e},go=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Eo=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},xo=0,se=[];function yo(e){var t=r.useRef([]),n=r.useRef([0,0]),o=r.useRef(),a=r.useState(xo++)[0],c=r.useState(function(){return cn()})[0],i=r.useRef(e);r.useEffect(function(){i.current=e},[e]),r.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var l=ln([e.lockRef.current],(e.shards||[]).map(At),!0).filter(Boolean);return l.forEach(function(b){return b.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),l.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=r.useCallback(function(l,b){if("touches"in l&&l.touches.length===2)return!i.current.allowPinchZoom;var $=Re(l),C=n.current,y="deltaX"in l?l.deltaX:C[0]-$[0],m="deltaY"in l?l.deltaY:C[1]-$[1],E,P=l.target,S=Math.abs(y)>Math.abs(m)?"h":"v";if("touches"in l&&S==="h"&&P.type==="range")return!1;var R=Dt(S,P);if(!R)return!0;if(R?E=S:(E=S==="v"?"h":"v",R=Dt(S,P)),!R)return!1;if(!o.current&&"changedTouches"in l&&(y||m)&&(o.current=E),!E)return!0;var A=o.current||E;return $o(A,b,l,A==="h"?y:m,!0)},[]),d=r.useCallback(function(l){var b=l;if(!(!se.length||se[se.length-1]!==c)){var $="deltaY"in b?Ot(b):Re(b),C=t.current.filter(function(E){return E.name===b.type&&E.target===b.target&&go(E.delta,$)})[0];if(C&&C.should){b.preventDefault();return}if(!C){var y=(i.current.shards||[]).map(At).filter(Boolean).filter(function(E){return E.contains(b.target)}),m=y.length>0?s(b,y[0]):!i.current.noIsolation;m&&b.preventDefault()}}},[]),u=r.useCallback(function(l,b,$,C){var y={name:l,delta:b,target:$,should:C};t.current.push(y),setTimeout(function(){t.current=t.current.filter(function(m){return m!==y})},1)},[]),h=r.useCallback(function(l){n.current=Re(l),o.current=void 0},[]),v=r.useCallback(function(l){u(l.type,Ot(l),l.target,s(l,e.lockRef.current))},[]),x=r.useCallback(function(l){u(l.type,Re(l),l.target,s(l,e.lockRef.current))},[]);r.useEffect(function(){return se.push(c),e.setCallbacks({onScrollCapture:v,onWheelCapture:v,onTouchMoveCapture:x}),document.addEventListener("wheel",d,ae),document.addEventListener("touchmove",d,ae),document.addEventListener("touchstart",h,ae),function(){se=se.filter(function(l){return l!==c}),document.removeEventListener("wheel",d,ae),document.removeEventListener("touchmove",d,ae),document.removeEventListener("touchstart",h,ae)}},[]);var p=e.removeScrollBar,g=e.inert;return r.createElement(r.Fragment,null,g?r.createElement(c,{styles:Eo(a)}):null,p?r.createElement(dn,{gapMode:"margin"}):null)}const wo=un(gn,yo);var yn=r.forwardRef(function(e,t){return r.createElement(Le,q({},e,{ref:t,sideCar:wo}))});yn.classNames=Le.classNames;const Co=yn,wn="Dialog",[Cn,ks]=Lr(wn),[Po,oe]=Cn(wn),So=e=>{const{__scopeDialog:t,children:n,open:o,defaultOpen:a,onOpenChange:c,modal:i=!0}=e,s=r.useRef(null),d=r.useRef(null),[u=!1,h]=Br({prop:o,defaultProp:a,onChange:c});return r.createElement(Po,{scope:t,triggerRef:s,contentRef:d,contentId:We(),titleId:We(),descriptionId:We(),open:u,onOpenChange:h,onOpenToggle:r.useCallback(()=>h(v=>!v),[h]),modal:i},n)},Pn="DialogPortal",[No,Sn]=Cn(Pn,{forceMount:void 0}),_o=e=>{const{__scopeDialog:t,forceMount:n,children:o,container:a}=e,c=oe(Pn,t);return r.createElement(No,{scope:t,forceMount:n},r.Children.map(o,i=>r.createElement(ke,{present:n||c.open},r.createElement(io,{asChild:!0,container:a},i))))},st="DialogOverlay",Ro=r.forwardRef((e,t)=>{const n=Sn(st,e.__scopeDialog),{forceMount:o=n.forceMount,...a}=e,c=oe(st,e.__scopeDialog);return c.modal?r.createElement(ke,{present:o||c.open},r.createElement(Do,L({},a,{ref:t}))):null}),Do=r.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,a=oe(st,n);return r.createElement(Co,{as:mt,allowPinchZoom:!0,shards:[a.contentRef]},r.createElement(Te.div,L({"data-state":_n(a.open)},o,{ref:t,style:{pointerEvents:"auto",...o.style}})))}),be="DialogContent",Oo=r.forwardRef((e,t)=>{const n=Sn(be,e.__scopeDialog),{forceMount:o=n.forceMount,...a}=e,c=oe(be,e.__scopeDialog);return r.createElement(ke,{present:o||c.open},c.modal?r.createElement(Ao,L({},a,{ref:t})):r.createElement(Fo,L({},a,{ref:t})))}),Ao=r.forwardRef((e,t)=>{const n=oe(be,e.__scopeDialog),o=r.useRef(null),a=Ee(t,n.contentRef,o);return r.useEffect(()=>{const c=o.current;if(c)return fn(c)},[]),r.createElement(Nn,L({},e,{ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:de(e.onCloseAutoFocus,c=>{var i;c.preventDefault(),(i=n.triggerRef.current)===null||i===void 0||i.focus()}),onPointerDownOutside:de(e.onPointerDownOutside,c=>{const i=c.detail.originalEvent,s=i.button===0&&i.ctrlKey===!0;(i.button===2||s)&&c.preventDefault()}),onFocusOutside:de(e.onFocusOutside,c=>c.preventDefault())}))}),Fo=r.forwardRef((e,t)=>{const n=oe(be,e.__scopeDialog),o=r.useRef(!1);return r.createElement(Nn,L({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var c;if((c=e.onCloseAutoFocus)===null||c===void 0||c.call(e,a),!a.defaultPrevented){var i;o.current||(i=n.triggerRef.current)===null||i===void 0||i.focus(),a.preventDefault()}o.current=!1},onInteractOutside:a=>{var c,i;(c=e.onInteractOutside)===null||c===void 0||c.call(e,a),a.defaultPrevented||(o.current=!0);const s=a.target;((i=n.triggerRef.current)===null||i===void 0?void 0:i.contains(s))&&a.preventDefault()}}))}),Nn=r.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:o,onOpenAutoFocus:a,onCloseAutoFocus:c,...i}=e,s=oe(be,n),d=r.useRef(null),u=Ee(t,d);return fo(),r.createElement(r.Fragment,null,r.createElement(to,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:a,onUnmountAutoFocus:c},r.createElement(Jr,L({role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":_n(s.open)},i,{ref:u,onDismiss:()=>s.onOpenChange(!1)}))),!1)});function _n(e){return e?"open":"closed"}const jo=So,To=_o,ko=Ro,Lo=Oo;var Ft=1,Mo=.9,Io=.3,Ve=.1,Uo=0,Ye=.999,Bo=.9999,Wo=.99,jt=/[\\\/\-_+.# \t"@\[\(\{&]/,zo=/[\\\/\-_+.# \t"@\[\(\{&]/g;function ct(e,t,n,o,a,c){if(c===t.length)return a===e.length?Ft:Wo;for(var i=o.charAt(c),s=n.indexOf(i,a),d=0,u,h,v;s>=0;)u=ct(e,t,n,o,s+1,c+1),u>d&&(s===a?u*=Ft:jt.test(e.charAt(s-1))?(u*=Mo,v=e.slice(a,s-1).match(zo),v&&a>0&&(u*=Math.pow(Ye,v.length))):jt.test(e.slice(a,s-1))?(u*=Uo,a>0&&(u*=Math.pow(Ye,s-a))):(u*=Io,a>0&&(u*=Math.pow(Ye,s-a))),e.charAt(s)!==t.charAt(c)&&(u*=Bo)),u<Ve&&n.charAt(s-1)===o.charAt(c+1)&&n.charAt(s-1)!==o.charAt(c)&&(h=ct(e,t,n,o,s+1,c+2),h*Ve>u&&(u=h*Ve)),u>d&&(d=u),s=n.indexOf(i,s+1);return d}function Ho(e,t){return ct(e,t,e.toLowerCase(),t.toLowerCase(),0,0)}var Ko=Ho;const qo=fr(Ko);var Vo='[cmdk-list-sizer=""]',he='[cmdk-group=""]',Xe='[cmdk-group-items=""]',Yo='[cmdk-group-heading=""]',Rn='[cmdk-item=""]',Tt=`${Rn}:not([aria-disabled="true"])`,it="cmdk-item-select",Q="data-value",Xo=(e,t)=>qo(e,t),Dn=r.createContext(void 0),xe=()=>r.useContext(Dn),On=r.createContext(void 0),vt=()=>r.useContext(On),An=r.createContext(void 0),Fn=r.forwardRef((e,t)=>{let n=r.useRef(null),o=le(()=>({search:"",value:"",filtered:{count:0,items:new Map,groups:new Set}})),a=le(()=>new Set),c=le(()=>new Map),i=le(()=>new Map),s=le(()=>new Set),d=jn(e),{label:u,children:h,value:v,onValueChange:x,filter:p,shouldFilter:g,...l}=e,b=r.useId(),$=r.useId(),C=r.useId(),y=sa();ve(()=>{if(v!==void 0){let w=v.trim().toLowerCase();o.current.value=w,y(6,U),m.emit()}},[v]);let m=r.useMemo(()=>({subscribe:w=>(s.current.add(w),()=>s.current.delete(w)),snapshot:()=>o.current,setState:(w,O,T)=>{var D,M,B;if(!Object.is(o.current[w],O)){if(o.current[w]=O,w==="search")A(),S(),y(1,R);else if(w==="value")if(((D=d.current)==null?void 0:D.value)!==void 0){(B=(M=d.current).onValueChange)==null||B.call(M,O);return}else T||y(5,U);m.emit()}},emit:()=>{s.current.forEach(w=>w())}}),[]),E=r.useMemo(()=>({value:(w,O)=>{O!==i.current.get(w)&&(i.current.set(w,O),o.current.filtered.items.set(w,P(O)),y(2,()=>{S(),m.emit()}))},item:(w,O)=>(a.current.add(w),O&&(c.current.has(O)?c.current.get(O).add(w):c.current.set(O,new Set([w]))),y(3,()=>{A(),S(),o.current.value||R(),m.emit()}),()=>{i.current.delete(w),a.current.delete(w),o.current.filtered.items.delete(w),y(4,()=>{A(),R(),m.emit()})}),group:w=>(c.current.has(w)||c.current.set(w,new Set),()=>{i.current.delete(w),c.current.delete(w)}),filter:()=>d.current.shouldFilter,label:u||e["aria-label"],listId:b,inputId:C,labelId:$}),[]);function P(w){var O;let T=((O=d.current)==null?void 0:O.filter)??Xo;return w?T(w,o.current.search):0}function S(){if(!n.current||!o.current.search||d.current.shouldFilter===!1)return;let w=o.current.filtered.items,O=[];o.current.filtered.groups.forEach(D=>{let M=c.current.get(D),B=0;M.forEach(X=>{let J=w.get(X);B=Math.max(J,B)}),O.push([D,B])});let T=n.current.querySelector(Vo);_().sort((D,M)=>{let B=D.getAttribute(Q),X=M.getAttribute(Q);return(w.get(X)??0)-(w.get(B)??0)}).forEach(D=>{let M=D.closest(Xe);M?M.appendChild(D.parentElement===M?D:D.closest(`${Xe} > *`)):T.appendChild(D.parentElement===T?D:D.closest(`${Xe} > *`))}),O.sort((D,M)=>M[1]-D[1]).forEach(D=>{let M=n.current.querySelector(`${he}[${Q}="${D[0]}"]`);M==null||M.parentElement.appendChild(M)})}function R(){let w=_().find(T=>!T.ariaDisabled),O=w==null?void 0:w.getAttribute(Q);m.setState("value",O||void 0)}function A(){if(!o.current.search||d.current.shouldFilter===!1){o.current.filtered.count=a.current.size;return}o.current.filtered.groups=new Set;let w=0;for(let O of a.current){let T=i.current.get(O),D=P(T);o.current.filtered.items.set(O,D),D>0&&w++}for(let[O,T]of c.current)for(let D of T)if(o.current.filtered.items.get(D)>0){o.current.filtered.groups.add(O);break}o.current.filtered.count=w}function U(){var w,O,T;let D=N();D&&(((w=D.parentElement)==null?void 0:w.firstChild)===D&&((T=(O=D.closest(he))==null?void 0:O.querySelector(Yo))==null||T.scrollIntoView({block:"nearest"})),D.scrollIntoView({block:"nearest"}))}function N(){return n.current.querySelector(`${Rn}[aria-selected="true"]`)}function _(){return Array.from(n.current.querySelectorAll(Tt))}function F(w){let O=_()[w];O&&m.setState("value",O.getAttribute(Q))}function j(w){var O;let T=N(),D=_(),M=D.findIndex(X=>X===T),B=D[M+w];(O=d.current)!=null&&O.loop&&(B=M+w<0?D[D.length-1]:M+w===D.length?D[0]:D[M+w]),B&&m.setState("value",B.getAttribute(Q))}function k(w){let O=N(),T=O==null?void 0:O.closest(he),D;for(;T&&!D;)T=w>0?oa(T,he):aa(T,he),D=T==null?void 0:T.querySelector(Tt);D?m.setState("value",D.getAttribute(Q)):j(w)}let I=()=>F(_().length-1),Y=w=>{w.preventDefault(),w.metaKey?I():w.altKey?k(1):j(1)},Z=w=>{w.preventDefault(),w.metaKey?F(0):w.altKey?k(-1):j(-1)};return r.createElement("div",{ref:ye([n,t]),...l,"cmdk-root":"",onKeyDown:w=>{var O;if((O=l.onKeyDown)==null||O.call(l,w),!w.defaultPrevented)switch(w.key){case"n":case"j":{w.ctrlKey&&Y(w);break}case"ArrowDown":{Y(w);break}case"p":case"k":{w.ctrlKey&&Z(w);break}case"ArrowUp":{Z(w);break}case"Home":{w.preventDefault(),F(0);break}case"End":{w.preventDefault(),I();break}case"Enter":{w.preventDefault();let T=N();if(T){let D=new Event(it);T.dispatchEvent(D)}}}}},r.createElement("label",{"cmdk-label":"",htmlFor:E.inputId,id:E.labelId,style:ca},u),r.createElement(On.Provider,{value:m},r.createElement(Dn.Provider,{value:E},h)))}),Go=r.forwardRef((e,t)=>{let n=r.useId(),o=r.useRef(null),a=r.useContext(An),c=xe(),i=jn(e);ve(()=>c.item(n,a),[]);let s=Tn(n,o,[e.value,e.children,o]),d=vt(),u=fe($=>$.value&&$.value===s.current),h=fe($=>c.filter()===!1?!0:$.search?$.filtered.items.get(n)>0:!0);r.useEffect(()=>{let $=o.current;if(!(!$||e.disabled))return $.addEventListener(it,v),()=>$.removeEventListener(it,v)},[h,e.onSelect,e.disabled]);function v(){var $,C;(C=($=i.current).onSelect)==null||C.call($,s.current)}function x(){d.setState("value",s.current,!0)}if(!h)return null;let{disabled:p,value:g,onSelect:l,...b}=e;return r.createElement("div",{ref:ye([o,t]),...b,"cmdk-item":"",role:"option","aria-disabled":p||void 0,"aria-selected":u||void 0,"data-selected":u||void 0,onPointerMove:p?void 0:x,onClick:p?void 0:v},e.children)}),Zo=r.forwardRef((e,t)=>{let{heading:n,children:o,...a}=e,c=r.useId(),i=r.useRef(null),s=r.useRef(null),d=r.useId(),u=xe(),h=fe(x=>u.filter()===!1?!0:x.search?x.filtered.groups.has(c):!0);ve(()=>u.group(c),[]),Tn(c,i,[e.value,e.heading,s]);let v=r.createElement(An.Provider,{value:c},o);return r.createElement("div",{ref:ye([i,t]),...a,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},n&&r.createElement("div",{ref:s,"cmdk-group-heading":"","aria-hidden":!0,id:d},n),r.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?d:void 0},v))}),Jo=r.forwardRef((e,t)=>{let{alwaysRender:n,...o}=e,a=r.useRef(null),c=fe(i=>!i.search);return!n&&!c?null:r.createElement("div",{ref:ye([a,t]),...o,"cmdk-separator":"",role:"separator"})}),Qo=r.forwardRef((e,t)=>{let{onValueChange:n,...o}=e,a=e.value!=null,c=vt(),i=fe(d=>d.search),s=xe();return r.useEffect(()=>{e.value!=null&&c.setState("search",e.value)},[e.value]),r.createElement("input",{ref:t,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":s.listId,"aria-labelledby":s.labelId,id:s.inputId,type:"text",value:a?e.value:i,onChange:d=>{a||c.setState("search",d.target.value),n==null||n(d.target.value)}})}),ea=r.forwardRef((e,t)=>{let{children:n,...o}=e,a=r.useRef(null),c=r.useRef(null),i=xe();return r.useEffect(()=>{if(c.current&&a.current){let s=c.current,d=a.current,u,h=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let v=s.getBoundingClientRect().height;d.style.setProperty("--cmdk-list-height",v.toFixed(1)+"px")})});return h.observe(s),()=>{cancelAnimationFrame(u),h.unobserve(s)}}},[]),r.createElement("div",{ref:ye([a,t]),...o,"cmdk-list":"",role:"listbox","aria-label":"Suggestions",id:i.listId,"aria-labelledby":i.inputId},r.createElement("div",{ref:c,"cmdk-list-sizer":""},n))}),ta=r.forwardRef((e,t)=>{let{open:n,onOpenChange:o,container:a,...c}=e;return r.createElement(jo,{open:n,onOpenChange:o},r.createElement(To,{container:a},r.createElement(ko,{"cmdk-overlay":""}),r.createElement(Lo,{"aria-label":e.label,"cmdk-dialog":""},r.createElement(Fn,{ref:t,...c}))))}),na=r.forwardRef((e,t)=>{let n=r.useRef(!0),o=fe(a=>a.filtered.count===0);return r.useEffect(()=>{n.current=!1},[]),n.current||!o?null:r.createElement("div",{ref:t,...e,"cmdk-empty":"",role:"presentation"})}),ra=r.forwardRef((e,t)=>{let{progress:n,children:o,...a}=e;return r.createElement("div",{ref:t,...a,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Loading..."},r.createElement("div",{"aria-hidden":!0},o))}),z=Object.assign(Fn,{List:ea,Item:Go,Input:Qo,Group:Zo,Separator:Jo,Dialog:ta,Empty:na,Loading:ra});function oa(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function aa(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function jn(e){let t=r.useRef(e);return ve(()=>{t.current=e}),t}var ve=typeof window>"u"?r.useEffect:r.useLayoutEffect;function le(e){let t=r.useRef();return t.current===void 0&&(t.current=e()),t}function ye(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function fe(e){let t=vt(),n=()=>e(t.snapshot());return r.useSyncExternalStore(t.subscribe,n,n)}function Tn(e,t,n){let o=r.useRef(),a=xe();return ve(()=>{var c;let i=(()=>{var s;for(let d of n){if(typeof d=="string")return d.trim().toLowerCase();if(typeof d=="object"&&"current"in d&&d.current)return(s=d.current.textContent)==null?void 0:s.trim().toLowerCase()}})();a.value(e,i),(c=t.current)==null||c.setAttribute(Q,i),o.current=i}),o}var sa=()=>{let[e,t]=r.useState(),n=le(()=>new Map);return ve(()=>{n.current.forEach(o=>o()),n.current=new Map},[e]),(o,a)=>{n.current.set(o,a),t({})}},ca={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const ia=H.forwardRef(({className:e,...t},n)=>f.jsx(z,{ref:n,className:re("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));ia.displayName=z.displayName;const la=H.forwardRef(({className:e,...t},n)=>f.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[f.jsx(mn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),f.jsx(z.Input,{ref:n,className:re("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));la.displayName=z.Input.displayName;const da=H.forwardRef(({className:e,...t},n)=>f.jsx(z.List,{ref:n,className:re("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));da.displayName=z.List.displayName;const ua=H.forwardRef((e,t)=>f.jsx(z.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));ua.displayName=z.Empty.displayName;const fa=H.forwardRef(({className:e,...t},n)=>f.jsx(z.Group,{ref:n,className:re("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));fa.displayName=z.Group.displayName;const ma=H.forwardRef(({className:e,...t},n)=>f.jsx(z.Separator,{ref:n,className:re("-mx-1 h-px bg-border",e),...t}));ma.displayName=z.Separator.displayName;const va=H.forwardRef(({className:e,...t},n)=>f.jsx(z.Item,{ref:n,className:re("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t}));va.displayName=z.Item.displayName;function ue(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function pa(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function kn(...e){return t=>e.forEach(n=>pa(n,t))}function we(...e){return r.useCallback(kn(...e),e)}function Ln(e,t=[]){let n=[];function o(c,i){const s=r.createContext(i),d=n.length;n=[...n,i];function u(v){const{scope:x,children:p,...g}=v,l=(x==null?void 0:x[e][d])||s,b=r.useMemo(()=>g,Object.values(g));return r.createElement(l.Provider,{value:b},p)}function h(v,x){const p=(x==null?void 0:x[e][d])||s,g=r.useContext(p);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${v}\` must be used within \`${c}\``)}return u.displayName=c+"Provider",[u,h]}const a=()=>{const c=n.map(i=>r.createContext(i));return function(s){const d=(s==null?void 0:s[e])||c;return r.useMemo(()=>({[`__scope${e}`]:{...s,[e]:d}}),[s,d])}};return a.scopeName=e,[o,ha(a,...t)]}function ha(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const o=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const i=o.reduce((s,{useScope:d,scopeName:u})=>{const v=d(c)[`__scope${u}`];return{...s,...v}},{});return r.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}const pt=r.forwardRef((e,t)=>{const{children:n,...o}=e,a=r.Children.toArray(n),c=a.find($a);if(c){const i=c.props.children,s=a.map(d=>d===c?r.Children.count(i)>1?r.Children.only(null):r.isValidElement(i)?i.props.children:null:d);return r.createElement(lt,L({},o,{ref:t}),r.isValidElement(i)?r.cloneElement(i,void 0,s):null)}return r.createElement(lt,L({},o,{ref:t}),n)});pt.displayName="Slot";const lt=r.forwardRef((e,t)=>{const{children:n,...o}=e;return r.isValidElement(n)?r.cloneElement(n,{...ga(o,n.props),ref:t?kn(t,n.ref):n.ref}):r.Children.count(n)>1?r.Children.only(null):null});lt.displayName="SlotClone";const ba=({children:e})=>r.createElement(r.Fragment,null,e);function $a(e){return r.isValidElement(e)&&e.type===ba}function ga(e,t){const n={...t};for(const o in t){const a=e[o],c=t[o];/^on[A-Z]/.test(o)?a&&c?n[o]=(...s)=>{c(...s),a(...s)}:a&&(n[o]=a):o==="style"?n[o]={...a,...c}:o==="className"&&(n[o]=[a,c].filter(Boolean).join(" "))}return{...e,...n}}const Ea=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Me=Ea.reduce((e,t)=>{const n=r.forwardRef((o,a)=>{const{asChild:c,...i}=o,s=c?pt:t;return r.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),r.createElement(s,L({},i,{ref:a}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function xa(e,t){e&&je.flushSync(()=>e.dispatchEvent(t))}function me(e){const t=r.useRef(e);return r.useEffect(()=>{t.current=e}),r.useMemo(()=>(...n)=>{var o;return(o=t.current)===null||o===void 0?void 0:o.call(t,...n)},[])}function ya(e,t=globalThis==null?void 0:globalThis.document){const n=me(e);r.useEffect(()=>{const o=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",o),()=>t.removeEventListener("keydown",o)},[n,t])}const dt="dismissableLayer.update",wa="dismissableLayer.pointerDownOutside",Ca="dismissableLayer.focusOutside";let kt;const Pa=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Sa=r.forwardRef((e,t)=>{var n;const{disableOutsidePointerEvents:o=!1,onEscapeKeyDown:a,onPointerDownOutside:c,onFocusOutside:i,onInteractOutside:s,onDismiss:d,...u}=e,h=r.useContext(Pa),[v,x]=r.useState(null),p=(n=v==null?void 0:v.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,g]=r.useState({}),l=we(t,R=>x(R)),b=Array.from(h.layers),[$]=[...h.layersWithOutsidePointerEventsDisabled].slice(-1),C=b.indexOf($),y=v?b.indexOf(v):-1,m=h.layersWithOutsidePointerEventsDisabled.size>0,E=y>=C,P=Na(R=>{const A=R.target,U=[...h.branches].some(N=>N.contains(A));!E||U||(c==null||c(R),s==null||s(R),R.defaultPrevented||d==null||d())},p),S=_a(R=>{const A=R.target;[...h.branches].some(N=>N.contains(A))||(i==null||i(R),s==null||s(R),R.defaultPrevented||d==null||d())},p);return ya(R=>{y===h.layers.size-1&&(a==null||a(R),!R.defaultPrevented&&d&&(R.preventDefault(),d()))},p),r.useEffect(()=>{if(v)return o&&(h.layersWithOutsidePointerEventsDisabled.size===0&&(kt=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(v)),h.layers.add(v),Lt(),()=>{o&&h.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=kt)}},[v,p,o,h]),r.useEffect(()=>()=>{v&&(h.layers.delete(v),h.layersWithOutsidePointerEventsDisabled.delete(v),Lt())},[v,h]),r.useEffect(()=>{const R=()=>g({});return document.addEventListener(dt,R),()=>document.removeEventListener(dt,R)},[]),r.createElement(Me.div,L({},u,{ref:l,style:{pointerEvents:m?E?"auto":"none":void 0,...e.style},onFocusCapture:ue(e.onFocusCapture,S.onFocusCapture),onBlurCapture:ue(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:ue(e.onPointerDownCapture,P.onPointerDownCapture)}))});function Na(e,t=globalThis==null?void 0:globalThis.document){const n=me(e),o=r.useRef(!1),a=r.useRef(()=>{});return r.useEffect(()=>{const c=s=>{if(s.target&&!o.current){let u=function(){Mn(wa,n,d,{discrete:!0})};const d={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=u,t.addEventListener("click",a.current,{once:!0})):u()}else t.removeEventListener("click",a.current);o.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",c),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>o.current=!0}}function _a(e,t=globalThis==null?void 0:globalThis.document){const n=me(e),o=r.useRef(!1);return r.useEffect(()=>{const a=c=>{c.target&&!o.current&&Mn(Ca,n,{originalEvent:c},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}function Lt(){const e=new CustomEvent(dt);document.dispatchEvent(e)}function Mn(e,t,n,{discrete:o}){const a=n.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),o?xa(a,c):a.dispatchEvent(c)}let Ge=0;function Ra(){r.useEffect(()=>{var e,t;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=n[0])!==null&&e!==void 0?e:Mt()),document.body.insertAdjacentElement("beforeend",(t=n[1])!==null&&t!==void 0?t:Mt()),Ge++,()=>{Ge===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(o=>o.remove()),Ge--}},[])}function Mt(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}const Ze="focusScope.autoFocusOnMount",Je="focusScope.autoFocusOnUnmount",It={bubbles:!1,cancelable:!0},Da=r.forwardRef((e,t)=>{const{loop:n=!1,trapped:o=!1,onMountAutoFocus:a,onUnmountAutoFocus:c,...i}=e,[s,d]=r.useState(null),u=me(a),h=me(c),v=r.useRef(null),x=we(t,l=>d(l)),p=r.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;r.useEffect(()=>{if(o){let l=function(y){if(p.paused||!s)return;const m=y.target;s.contains(m)?v.current=m:ee(v.current,{select:!0})},b=function(y){if(p.paused||!s)return;const m=y.relatedTarget;m!==null&&(s.contains(m)||ee(v.current,{select:!0}))},$=function(y){if(document.activeElement===document.body)for(const E of y)E.removedNodes.length>0&&ee(s)};document.addEventListener("focusin",l),document.addEventListener("focusout",b);const C=new MutationObserver($);return s&&C.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",l),document.removeEventListener("focusout",b),C.disconnect()}}},[o,s,p.paused]),r.useEffect(()=>{if(s){Bt.add(p);const l=document.activeElement;if(!s.contains(l)){const $=new CustomEvent(Ze,It);s.addEventListener(Ze,u),s.dispatchEvent($),$.defaultPrevented||(Oa(ka(In(s)),{select:!0}),document.activeElement===l&&ee(s))}return()=>{s.removeEventListener(Ze,u),setTimeout(()=>{const $=new CustomEvent(Je,It);s.addEventListener(Je,h),s.dispatchEvent($),$.defaultPrevented||ee(l??document.body,{select:!0}),s.removeEventListener(Je,h),Bt.remove(p)},0)}}},[s,u,h,p]);const g=r.useCallback(l=>{if(!n&&!o||p.paused)return;const b=l.key==="Tab"&&!l.altKey&&!l.ctrlKey&&!l.metaKey,$=document.activeElement;if(b&&$){const C=l.currentTarget,[y,m]=Aa(C);y&&m?!l.shiftKey&&$===m?(l.preventDefault(),n&&ee(y,{select:!0})):l.shiftKey&&$===y&&(l.preventDefault(),n&&ee(m,{select:!0})):$===C&&l.preventDefault()}},[n,o,p.paused]);return r.createElement(Me.div,L({tabIndex:-1},i,{ref:x,onKeyDown:g}))});function Oa(e,{select:t=!1}={}){const n=document.activeElement;for(const o of e)if(ee(o,{select:t}),document.activeElement!==n)return}function Aa(e){const t=In(e),n=Ut(t,e),o=Ut(t.reverse(),e);return[n,o]}function In(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const a=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||a?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Ut(e,t){for(const n of e)if(!Fa(n,{upTo:t}))return n}function Fa(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function ja(e){return e instanceof HTMLInputElement&&"select"in e}function ee(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&ja(e)&&t&&e.select()}}const Bt=Ta();function Ta(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Wt(e,t),e.unshift(t)},remove(t){var n;e=Wt(e,t),(n=e[0])===null||n===void 0||n.resume()}}}function Wt(e,t){const n=[...e],o=n.indexOf(t);return o!==-1&&n.splice(o,1),n}function ka(e){return e.filter(t=>t.tagName!=="A")}const $e=globalThis!=null&&globalThis.document?r.useLayoutEffect:()=>{};function La(e){const[t,n]=r.useState(void 0);return $e(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const o=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const c=a[0];let i,s;if("borderBoxSize"in c){const d=c.borderBoxSize,u=Array.isArray(d)?d[0]:d;i=u.inlineSize,s=u.blockSize}else i=e.offsetWidth,s=e.offsetHeight;n({width:i,height:s})});return o.observe(e,{box:"border-box"}),()=>o.unobserve(e)}else n(void 0)},[e]),t}const Un="Popper",[Bn,Wn]=Ln(Un),[Ls,Ma]=Bn(Un),zn="PopperContent",[Ia,Ms]=Bn(zn),Ua=r.forwardRef((e,t)=>{var n,o,a,c,i,s,d,u;const{__scopePopper:h,side:v="bottom",sideOffset:x=0,align:p="center",alignOffset:g=0,arrowPadding:l=0,avoidCollisions:b=!0,collisionBoundary:$=[],collisionPadding:C=0,sticky:y="partial",hideWhenDetached:m=!1,updatePositionStrategy:E="optimized",onPlaced:P,...S}=e,R=Ma(zn,h),[A,U]=r.useState(null),N=we(t,pe=>U(pe)),[_,F]=r.useState(null),j=La(_),k=(n=j==null?void 0:j.width)!==null&&n!==void 0?n:0,I=(o=j==null?void 0:j.height)!==null&&o!==void 0?o:0,Y=v+(p!=="center"?"-"+p:""),Z=typeof C=="number"?C:{top:0,right:0,bottom:0,left:0,...C},w=Array.isArray($)?$:[$],O=w.length>0,T={padding:Z,boundary:w.filter(Ba),altBoundary:O},{refs:D,floatingStyles:M,placement:B,isPositioned:X,middlewareData:J}=mr({strategy:"fixed",placement:Y,whileElementsMounted:(...pe)=>vr(...pe,{animationFrame:E==="always"}),elements:{reference:R.anchor},middleware:[pr({mainAxis:x+I,alignmentAxis:g}),b&&hr({mainAxis:!0,crossAxis:!1,limiter:y==="partial"?br():void 0,...T}),b&&$r({...T}),gr({...T,apply:({elements:pe,rects:$t,availableWidth:cr,availableHeight:ir})=>{const{width:lr,height:dr}=$t.reference,Se=pe.floating.style;Se.setProperty("--radix-popper-available-width",`${cr}px`),Se.setProperty("--radix-popper-available-height",`${ir}px`),Se.setProperty("--radix-popper-anchor-width",`${lr}px`),Se.setProperty("--radix-popper-anchor-height",`${dr}px`)}}),_&&Er({element:_,padding:l}),Wa({arrowWidth:k,arrowHeight:I}),m&&xr({strategy:"referenceHidden",...T})]}),[bt,tr]=Hn(B),Pe=me(P);$e(()=>{X&&(Pe==null||Pe())},[X,Pe]);const nr=(a=J.arrow)===null||a===void 0?void 0:a.x,rr=(c=J.arrow)===null||c===void 0?void 0:c.y,or=((i=J.arrow)===null||i===void 0?void 0:i.centerOffset)!==0,[ar,sr]=r.useState();return $e(()=>{A&&sr(window.getComputedStyle(A).zIndex)},[A]),r.createElement("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...M,transform:X?M.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ar,"--radix-popper-transform-origin":[(s=J.transformOrigin)===null||s===void 0?void 0:s.x,(d=J.transformOrigin)===null||d===void 0?void 0:d.y].join(" ")},dir:e.dir},r.createElement(Ia,{scope:h,placedSide:bt,onArrowChange:F,arrowX:nr,arrowY:rr,shouldHideArrow:or},r.createElement(Me.div,L({"data-side":bt,"data-align":tr},S,{ref:N,style:{...S.style,animation:X?void 0:"none",opacity:(u=J.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function Ba(e){return e!==null}const Wa=e=>({name:"transformOrigin",options:e,fn(t){var n,o,a,c,i;const{placement:s,rects:d,middlewareData:u}=t,v=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,x=v?0:e.arrowWidth,p=v?0:e.arrowHeight,[g,l]=Hn(s),b={start:"0%",center:"50%",end:"100%"}[l],$=((o=(a=u.arrow)===null||a===void 0?void 0:a.x)!==null&&o!==void 0?o:0)+x/2,C=((c=(i=u.arrow)===null||i===void 0?void 0:i.y)!==null&&c!==void 0?c:0)+p/2;let y="",m="";return g==="bottom"?(y=v?b:`${$}px`,m=`${-p}px`):g==="top"?(y=v?b:`${$}px`,m=`${d.floating.height+p}px`):g==="right"?(y=`${-p}px`,m=v?b:`${C}px`):g==="left"&&(y=`${d.floating.width+p}px`,m=v?b:`${C}px`),{data:{x:y,y:m}}}});function Hn(e){const[t,n="center"]=e.split("-");return[t,n]}const za=Ua,Ha=r.forwardRef((e,t)=>{var n;const{container:o=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...a}=e;return o?qt.createPortal(r.createElement(Me.div,L({},a,{ref:t})),o):null});function Ka(e,t){return r.useReducer((n,o)=>{const a=t[n][o];return a??n},e)}const ht=e=>{const{present:t,children:n}=e,o=qa(t),a=typeof n=="function"?n({present:o.isPresent}):r.Children.only(n),c=we(o.ref,a.ref);return typeof n=="function"||o.isPresent?r.cloneElement(a,{ref:c}):null};ht.displayName="Presence";function qa(e){const[t,n]=r.useState(),o=r.useRef({}),a=r.useRef(e),c=r.useRef("none"),i=e?"mounted":"unmounted",[s,d]=Ka(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return r.useEffect(()=>{const u=De(o.current);c.current=s==="mounted"?u:"none"},[s]),$e(()=>{const u=o.current,h=a.current;if(h!==e){const x=c.current,p=De(u);e?d("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(h&&x!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,d]),$e(()=>{if(t){const u=v=>{const p=De(o.current).includes(v.animationName);v.target===t&&p&&je.flushSync(()=>d("ANIMATION_END"))},h=v=>{v.target===t&&(c.current=De(o.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",u),t.addEventListener("animationend",u),()=>{t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",u),t.removeEventListener("animationend",u)}}else d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:r.useCallback(u=>{u&&(o.current=getComputedStyle(u)),n(u)},[])}}function De(e){return(e==null?void 0:e.animationName)||"none"}var Kn=nn(),Qe=function(){},Ie=r.forwardRef(function(e,t){var n=r.useRef(null),o=r.useState({onScrollCapture:Qe,onWheelCapture:Qe,onTouchMoveCapture:Qe}),a=o[0],c=o[1],i=e.forwardProps,s=e.children,d=e.className,u=e.removeScrollBar,h=e.enabled,v=e.shards,x=e.sideCar,p=e.noIsolation,g=e.inert,l=e.allowPinchZoom,b=e.as,$=b===void 0?"div":b,C=rn(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),y=x,m=on([n,t]),E=q(q({},C),a);return r.createElement(r.Fragment,null,h&&r.createElement(y,{sideCar:Kn,removeScrollBar:u,shards:v,noIsolation:p,inert:g,setCallbacks:c,allowPinchZoom:!!l,lockRef:n}),i?r.cloneElement(r.Children.only(s),q(q({},E),{ref:m})):r.createElement($,q({},E,{className:d,ref:m}),s))});Ie.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ie.classNames={fullWidth:an,zeroRight:sn};var ut=!1;if(typeof window<"u")try{var Oe=Object.defineProperty({},"passive",{get:function(){return ut=!0,!0}});window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch{ut=!1}var ce=ut?{passive:!1}:!1,Va=function(e){return e.tagName==="TEXTAREA"},qn=function(e,t){var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Va(e)&&n[t]==="visible")},Ya=function(e){return qn(e,"overflowY")},Xa=function(e){return qn(e,"overflowX")},zt=function(e,t){var n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=Vn(e,n);if(o){var a=Yn(e,n),c=a[1],i=a[2];if(c>i)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},Ga=function(e){var t=e.scrollTop,n=e.scrollHeight,o=e.clientHeight;return[t,n,o]},Za=function(e){var t=e.scrollLeft,n=e.scrollWidth,o=e.clientWidth;return[t,n,o]},Vn=function(e,t){return e==="v"?Ya(t):Xa(t)},Yn=function(e,t){return e==="v"?Ga(t):Za(t)},Ja=function(e,t){return e==="h"&&t==="rtl"?-1:1},Qa=function(e,t,n,o,a){var c=Ja(e,window.getComputedStyle(t).direction),i=c*o,s=n.target,d=t.contains(s),u=!1,h=i>0,v=0,x=0;do{var p=Yn(e,s),g=p[0],l=p[1],b=p[2],$=l-b-c*g;(g||$)&&Vn(e,s)&&(v+=$,x+=g),s=s.parentNode}while(!d&&s!==document.body||d&&(t.contains(s)||t===s));return(h&&(a&&v===0||!a&&i>v)||!h&&(a&&x===0||!a&&-i>x))&&(u=!0),u},Ae=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Ht=function(e){return[e.deltaX,e.deltaY]},Kt=function(e){return e&&"current"in e?e.current:e},es=function(e,t){return e[0]===t[0]&&e[1]===t[1]},ts=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},ns=0,ie=[];function rs(e){var t=r.useRef([]),n=r.useRef([0,0]),o=r.useRef(),a=r.useState(ns++)[0],c=r.useState(function(){return cn()})[0],i=r.useRef(e);r.useEffect(function(){i.current=e},[e]),r.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var l=ln([e.lockRef.current],(e.shards||[]).map(Kt),!0).filter(Boolean);return l.forEach(function(b){return b.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),l.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var s=r.useCallback(function(l,b){if("touches"in l&&l.touches.length===2)return!i.current.allowPinchZoom;var $=Ae(l),C=n.current,y="deltaX"in l?l.deltaX:C[0]-$[0],m="deltaY"in l?l.deltaY:C[1]-$[1],E,P=l.target,S=Math.abs(y)>Math.abs(m)?"h":"v";if("touches"in l&&S==="h"&&P.type==="range")return!1;var R=zt(S,P);if(!R)return!0;if(R?E=S:(E=S==="v"?"h":"v",R=zt(S,P)),!R)return!1;if(!o.current&&"changedTouches"in l&&(y||m)&&(o.current=E),!E)return!0;var A=o.current||E;return Qa(A,b,l,A==="h"?y:m,!0)},[]),d=r.useCallback(function(l){var b=l;if(!(!ie.length||ie[ie.length-1]!==c)){var $="deltaY"in b?Ht(b):Ae(b),C=t.current.filter(function(E){return E.name===b.type&&E.target===b.target&&es(E.delta,$)})[0];if(C&&C.should){b.cancelable&&b.preventDefault();return}if(!C){var y=(i.current.shards||[]).map(Kt).filter(Boolean).filter(function(E){return E.contains(b.target)}),m=y.length>0?s(b,y[0]):!i.current.noIsolation;m&&b.cancelable&&b.preventDefault()}}},[]),u=r.useCallback(function(l,b,$,C){var y={name:l,delta:b,target:$,should:C};t.current.push(y),setTimeout(function(){t.current=t.current.filter(function(m){return m!==y})},1)},[]),h=r.useCallback(function(l){n.current=Ae(l),o.current=void 0},[]),v=r.useCallback(function(l){u(l.type,Ht(l),l.target,s(l,e.lockRef.current))},[]),x=r.useCallback(function(l){u(l.type,Ae(l),l.target,s(l,e.lockRef.current))},[]);r.useEffect(function(){return ie.push(c),e.setCallbacks({onScrollCapture:v,onWheelCapture:v,onTouchMoveCapture:x}),document.addEventListener("wheel",d,ce),document.addEventListener("touchmove",d,ce),document.addEventListener("touchstart",h,ce),function(){ie=ie.filter(function(l){return l!==c}),document.removeEventListener("wheel",d,ce),document.removeEventListener("touchmove",d,ce),document.removeEventListener("touchstart",h,ce)}},[]);var p=e.removeScrollBar,g=e.inert;return r.createElement(r.Fragment,null,g?r.createElement(c,{styles:ts(a)}):null,p?r.createElement(dn,{gapMode:"margin"}):null)}const os=un(Kn,rs);var Xn=r.forwardRef(function(e,t){return r.createElement(Ie,q({},e,{ref:t,sideCar:os}))});Xn.classNames=Ie.classNames;const as=Xn,Gn="Popover",[Zn,Is]=Ln(Gn,[Wn]),ss=Wn(),[Us,Ce]=Zn(Gn),Jn="PopoverPortal",[cs,is]=Zn(Jn,{forceMount:void 0}),ls=e=>{const{__scopePopover:t,forceMount:n,children:o,container:a}=e,c=Ce(Jn,t);return r.createElement(cs,{scope:t,forceMount:n},r.createElement(ht,{present:n||c.open},r.createElement(Ha,{asChild:!0,container:a},o)))},ge="PopoverContent",ds=r.forwardRef((e,t)=>{const n=is(ge,e.__scopePopover),{forceMount:o=n.forceMount,...a}=e,c=Ce(ge,e.__scopePopover);return r.createElement(ht,{present:o||c.open},c.modal?r.createElement(us,L({},a,{ref:t})):r.createElement(fs,L({},a,{ref:t})))}),us=r.forwardRef((e,t)=>{const n=Ce(ge,e.__scopePopover),o=r.useRef(null),a=we(t,o),c=r.useRef(!1);return r.useEffect(()=>{const i=o.current;if(i)return fn(i)},[]),r.createElement(as,{as:pt,allowPinchZoom:!0},r.createElement(Qn,L({},e,{ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ue(e.onCloseAutoFocus,i=>{var s;i.preventDefault(),c.current||(s=n.triggerRef.current)===null||s===void 0||s.focus()}),onPointerDownOutside:ue(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,d=s.button===0&&s.ctrlKey===!0,u=s.button===2||d;c.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:ue(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})))}),fs=r.forwardRef((e,t)=>{const n=Ce(ge,e.__scopePopover),o=r.useRef(!1),a=r.useRef(!1);return r.createElement(Qn,L({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var i;if((i=e.onCloseAutoFocus)===null||i===void 0||i.call(e,c),!c.defaultPrevented){var s;o.current||(s=n.triggerRef.current)===null||s===void 0||s.focus(),c.preventDefault()}o.current=!1,a.current=!1},onInteractOutside:c=>{var i,s;(i=e.onInteractOutside)===null||i===void 0||i.call(e,c),c.defaultPrevented||(o.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=c.target;((s=n.triggerRef.current)===null||s===void 0?void 0:s.contains(d))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}}))}),Qn=r.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:o,onOpenAutoFocus:a,onCloseAutoFocus:c,disableOutsidePointerEvents:i,onEscapeKeyDown:s,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:h,...v}=e,x=Ce(ge,n),p=ss(n);return Ra(),r.createElement(Da,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:a,onUnmountAutoFocus:c},r.createElement(Sa,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:h,onEscapeKeyDown:s,onPointerDownOutside:d,onFocusOutside:u,onDismiss:()=>x.onOpenChange(!1)},r.createElement(za,L({"data-state":ms(x.open),role:"dialog",id:x.contentId},p,v,{ref:t,style:{...v.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function ms(e){return e?"open":"closed"}const vs=ls,er=ds,ps=H.forwardRef(({className:e,align:t="center",sideOffset:n=4,...o},a)=>f.jsx(vs,{children:f.jsx(er,{ref:a,align:t,sideOffset:n,className:re("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...o})}));ps.displayName=er.displayName;const hs=({item:e,index:t,handleItemChange:n,handleRemoveItem:o,isSaving:a,handleAplicarRendimento:c,produtosInventario:i,produtosDesossa:s})=>{var y;const[d,u]=r.useState(!1),[h,v]=r.useState(""),p=[...i.map(m=>({...m,origem:"inventario"})),...s.map(m=>({...m,origem:"desossa"}))].reduce((m,E)=>{const P=E.codigo.toLowerCase();return m.has(P)||m.set(P,E),m},new Map),g=Array.from(p.values()).filter(m=>m.codigo.toLowerCase().includes(h.toLowerCase())||m.nome.toLowerCase().includes(h.toLowerCase())),l=m=>{const E=Array.from(p.values()).find(P=>P.codigo===m);E&&(n(t,{codigoProduto:E.codigo,descricao:E.nome}),u(!1),v(""))},b=m=>{const E=Array.from(p.values()).find(P=>P.codigo.toLowerCase()===m.toLowerCase());E?n(t,{codigoProduto:E.codigo,descricao:E.nome}):n(t,{codigoProduto:m,descricao:e.descricao})},$=m=>{const E=Array.from(p.values()).find(P=>P.nome.toLowerCase().includes(m.toLowerCase()));E?n(t,{codigoProduto:E.codigo,descricao:E.nome}):n(t,{descricao:m})},C=["dianteiro","traseiro","serrote","boi_inteiro","ponta_de_agulha","costela"].includes(e.parte_boi);return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-10 gap-2 items-end border p-3 rounded-md relative",children:[f.jsxs("div",{className:"md:col-span-1",children:[f.jsx(W,{children:"Código"}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx(K,{value:e.codigoProduto||"",onChange:m=>b(m.target.value),placeholder:"Digite código...",disabled:a,className:"flex-1"}),f.jsx(V,{variant:"outline",size:"sm",onClick:()=>u(!0),disabled:a,className:"px-2",title:"Buscar produtos",children:f.jsx(mn,{className:"h-3 w-3"})})]})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx(W,{children:"Produto (Nome)"}),f.jsx(K,{value:e.descricao||"",onChange:m=>$(m.target.value),placeholder:"Digite nome do produto...",disabled:a})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx(W,{children:"Parte do Boi (Opcional)"}),f.jsxs(Jt,{value:e.parte_boi||"",onValueChange:m=>n(t,{parte_boi:m}),children:[f.jsx(Qt,{children:f.jsx(en,{placeholder:"Selecione"})}),f.jsx(tn,{children:yt.map(m=>f.jsx(tt,{value:m.value,children:m.label},m.value))})]})]}),f.jsxs("div",{children:[f.jsx(W,{children:"Qtd."}),f.jsx(K,{type:"number",value:e.quantidade||"",onChange:m=>n(t,{quantidade:m.target.value}),disabled:a})]}),f.jsxs("div",{children:[f.jsx(W,{children:"Vlr. Unit."}),f.jsx(K,{type:"number",step:"0.01",value:e.valorUnitario||"",onChange:m=>n(t,{valorUnitario:m.target.value}),disabled:a})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx(W,{children:"Vlr. Total"}),f.jsx(K,{value:e.valorTotal||"0.00",readOnly:!0,disabled:!0,className:"bg-muted/50"})]}),f.jsx(V,{variant:"ghost",size:"icon",onClick:()=>o(t),className:"text-destructive absolute top-1 right-1 md:static md:self-center md:justify-self-end",disabled:a,children:f.jsx(vn,{className:"h-4 w-4"})}),C&&f.jsxs(V,{onClick:()=>c(t),variant:"outline",size:"sm",className:"md:col-span-full mt-2 text-xs bg-sky-100 text-sky-800 border-sky-300 hover:bg-sky-200",disabled:a,children:['Calcular e Adicionar Cortes de "',(y=yt.find(m=>m.value===e.parte_boi))==null?void 0:y.label,'" com base na Desossa']})]}),f.jsx(Vt,{open:d,onOpenChange:u,children:f.jsxs(Yt,{className:"sm:max-w-2xl glass-card max-h-[80vh] flex flex-col",children:[f.jsxs(Xt,{children:[f.jsx(Gt,{children:"Selecionar Produto"}),f.jsx(Zt,{children:"Produtos disponíveis do inventário e dos cálculos de desossa"})]}),f.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden",children:[f.jsxs("div",{children:[f.jsx(W,{htmlFor:"searchProduto",children:"Buscar produto"}),f.jsx(K,{id:"searchProduto",placeholder:"Digite código ou nome do produto...",value:h,onChange:m=>v(m.target.value),autoFocus:!0})]}),f.jsx("div",{className:"flex-1 overflow-y-auto border rounded-md",children:f.jsx("div",{className:"grid grid-cols-1 gap-1 p-2",children:g.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:h?"Nenhum produto encontrado":"Digite para buscar produtos"}):g.map(m=>f.jsxs("button",{onClick:()=>l(m.codigo),className:"flex items-center justify-between p-3 text-left hover:bg-muted/50 rounded-md border border-transparent hover:border-border transition-colors",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("div",{className:"font-medium",children:m.codigo}),f.jsx("div",{className:"text-sm text-muted-foreground",children:m.nome})]}),f.jsx("div",{className:"text-xs px-2 py-1 rounded-full bg-primary/10 text-primary",children:m.origem==="inventario"?"Inventário":"Desossa"})]},`${m.codigo}-${m.origem}`))})})]})]})})]})},bs=({open:e,setOpen:t,currentNota:n,handleNotaChange:o,handleItemChange:a,handleAddItem:c,handleRemoveItem:i,handleSaveNota:s,isSaving:d,handleAplicarRendimento:u,produtosInventario:h,produtosDesossa:v,desossasRegistradas:x})=>{if(!n)return null;const p=typeof n.id=="string"&&n.id.startsWith("new_"),g=x||[];return f.jsx(Vt,{open:e,onOpenChange:t,children:f.jsxs(Yt,{className:"sm:max-w-[600px] md:max-w-[800px] lg:max-w-[1100px] glass-card max-h-[90vh] flex flex-col",children:[f.jsxs(Xt,{children:[f.jsx(Gt,{children:p?"Adicionar Nova Nota Fiscal":"Editar Nota Fiscal"}),f.jsxs(Zt,{children:["Preencha os detalhes da nota fiscal. O estoque será atualizado ao salvar.",f.jsx("br",{}),f.jsx("span",{className:"text-primary font-medium",children:"💡 Use o botão de busca (🔍) no campo Código para ver produtos do inventário e das desossas!"})]})]}),f.jsxs("div",{className:"flex-grow overflow-y-auto pr-2 space-y-4 py-4",children:[p&&f.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg border border-primary/20",children:[f.jsx(W,{htmlFor:"desossaRef",className:"font-semibold text-primary",children:"Entrada Rápida por Desossa"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Selecione uma desossa para preencher automaticamente os dados da carcaça."}),f.jsxs(Jt,{onValueChange:l=>o("desossa_id_ref",l),children:[f.jsx(Qt,{children:f.jsx(en,{placeholder:"Selecione uma desossa registrada..."})}),f.jsx(tn,{children:f.jsxs(_r,{children:[f.jsx(Rr,{children:"Desossas Recentes"}),g.length===0&&f.jsx(tt,{value:"no-desossa",disabled:!0,children:"Nenhuma desossa encontrada"}),g.map(l=>f.jsxs(tt,{value:l.id,children:["NF ",l.numero_nota_fiscal," (",new Date(l.data_chegada+"T00:00:00").toLocaleDateString("pt-BR"),") - R$ ",l.custo_total_carcaca]},l.id))]})})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx(W,{htmlFor:"numeroNotaModal",children:"Número da Nota"}),f.jsx(K,{id:"numeroNotaModal",value:n.numero_nota||"",onChange:l=>o("numero_nota",l.target.value),disabled:d})]}),f.jsxs("div",{children:[f.jsx(W,{htmlFor:"dataNotaModal",children:"Data da Nota"}),f.jsx(K,{id:"dataNotaModal",type:"date",value:n.data_nota||"",onChange:l=>o("data_nota",l.target.value),disabled:d})]})]}),f.jsxs("div",{children:[f.jsx(W,{htmlFor:"cnpjEmitenteModal",children:"CNPJ Emitente da Nota"}),f.jsx(K,{id:"cnpjEmitenteModal",value:n.cnpj_emitente||"",onChange:l=>o("cnpj_emitente",l.target.value),disabled:d})]}),f.jsx("h3",{className:"text-lg font-semibold mt-4 border-b pb-2",children:"Itens da Nota"}),n.items.map((l,b)=>f.jsx(hs,{item:l,index:b,handleItemChange:a,handleRemoveItem:i,isSaving:d,handleAplicarRendimento:u,produtosInventario:h,produtosDesossa:v},l.id||b)),f.jsxs(V,{onClick:c,variant:"outline",size:"sm",disabled:d,children:[f.jsx(pn,{className:"mr-2 h-4 w-4"})," Adicionar Item"]}),f.jsxs("div",{className:"mt-4",children:[f.jsx(W,{htmlFor:"linkPdfModal",children:"Link para o PDF da Nota"}),f.jsx(K,{id:"linkPdfModal",placeholder:"https://exemplo.com/nota.pdf",value:n.link_pdf||"",onChange:l=>o("link_pdf",l.target.value),className:"w-full p-2 border rounded bg-input/50",disabled:d})]}),f.jsxs("div",{className:"mt-4",children:[f.jsx(W,{htmlFor:"observacoesModal",children:"Observações"}),f.jsx("textarea",{id:"observacoesModal",value:n.observacoes||"",onChange:l=>o("observacoes",l.target.value),className:"w-full p-2 border rounded bg-input/50 min-h-[80px]",disabled:d})]}),f.jsxs("p",{className:"text-right font-bold text-xl mt-4",children:["Total Geral: ",f.jsx("span",{className:"text-primary",children:parseFloat(n.total_calculado||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]})]}),f.jsxs(Nr,{children:[f.jsx(V,{variant:"outline",onClick:()=>t(!1),disabled:d,children:"Cancelar"}),f.jsxs(V,{onClick:s,disabled:d,children:[d?f.jsx(et,{className:"mr-2"}):null,"Salvar Nota e Atualizar Estoque"]})]})]})})},$s=()=>{const{toast:e}=ft(),[t,n]=r.useState(null),[o,a]=r.useState([]),[c,i]=r.useState(!0),[s,d]=r.useState([]),[u,h]=r.useState([]),[v,x]=r.useState([]),p=r.useCallback(async g=>{if(!(!g||!g.id||!g.cnpj))try{const[l,b,$,C]=await Promise.all([G.from("parametros_rendimento_boi").select("codigo_peca, descricao_peca").eq("user_id",g.id).eq("cnpj_empresa",g.cnpj),G.from("inventario_fisico").select("codigo, nome").eq("user_id",g.id).eq("cnpj_loja",g.cnpj),G.from("notas_fiscais").select("*").eq("user_id",g.id).eq("cnpj_emitente",g.cnpj).order("created_at",{ascending:!1}),G.from("desossas_registradas").select("cortes_info").eq("user_id",g.id).eq("cnpj_empresa",g.cnpj).order("created_at",{ascending:!1}).limit(50)]);if(l.error)throw l.error;if(d(l.data||[]),b.error)throw b.error;if(h(b.data||[]),$.error)throw $.error;if(a($.data.map(m=>({...m,items:m.items.map((E,P)=>({...E,id:Date.now()+P+Math.random()}))}))||[]),C.error)throw C.error;const y=new Map;C.data.forEach(m=>{m.cortes_info&&Array.isArray(m.cortes_info)&&m.cortes_info.forEach(E=>{if(E.nome&&E.nome.trim()){const P=`${E.codigo_produto||""}-${E.nome}`.toLowerCase();y.has(P)||y.set(P,{codigo:E.codigo_produto||`AUTO-${Math.random().toString(36).substr(2,5).toUpperCase()}`,nome:E.nome.trim(),origem:"desossa"})}})}),x(Array.from(y.values()))}catch(l){e({title:"Erro ao Carregar Dados",description:l.message,variant:"destructive"})}finally{i(!1)}},[e]);return r.useEffect(()=>{const g=localStorage.getItem(yr);if(g){const l=JSON.parse(g);n(l)}else i(!1),e({title:"Erro de Autenticação",description:"Usuário não encontrado.",variant:"destructive"})},[e]),r.useEffect(()=>{t&&(i(!0),p(t))},[t,p]),{currentUser:t,notas:o,setNotas:a,loading:c,parametrosRendimento:s,produtosInventario:u,produtosDesossa:v,fetchInitialData:p}},gs=({currentUser:e,currentNota:t,parametrosRendimento:n,setNotas:o,setCurrentNota:a,setModalOpen:c,setIsSaving:i,fetchInitialData:s,toast:d})=>({handleSaveNota:async()=>{if(!t.numero_nota||!t.data_nota){d({title:"Erro",description:"Número e Data da Nota são obrigatórios.",variant:"destructive"});return}if(!e||!e.id||!e.cnpj){d({title:"Erro de Autenticação",description:"Usuário ou CNPJ não identificado.",variant:"destructive"});return}i(!0);const p={...t,user_id:e.id,cnpj_emitente:t.cnpj_emitente||e.cnpj,total_calculado:parseFloat(t.total_calculado),items:t.items.map(({id:l,...b})=>b)};let g=typeof t.id=="string"&&t.id.startsWith("new_");g&&delete p.id;try{let l;if(g){const{data:$,error:C}=await G.from("notas_fiscais").insert([p]).select();if(C)throw C;l=$[0],o(y=>[{...l,items:l.items.map((m,E)=>({...m,id:Date.now()+E+Math.random()}))},...y]),d({title:"Sucesso",description:"Nota fiscal adicionada."})}else{const{data:$,error:C}=await G.from("notas_fiscais").update(p).eq("id",t.id).eq("user_id",e.id).select();if(C)throw C;l=$[0],o(y=>y.map(m=>m.id===t.id?{...l,items:l.items.map((E,P)=>({...E,id:Date.now()+P+Math.random()}))}:m)),d({title:"Sucesso",description:"Nota fiscal atualizada."})}const{error:b}=await G.rpc("update_inventory_from_note",{items_jsonb:JSON.stringify(l.items),user_uuid:e.id,cnpj_text:e.cnpj});if(b)throw console.error("RPC Error:",b),new Error(`Erro ao atualizar o inventário: ${b.message}`);d({title:"Estoque Atualizado",description:"O inventário foi atualizado com os itens da nota."}),s(e),c(!1),a(null)}catch(l){d({title:"Erro ao Salvar Nota",description:l.message,variant:"destructive"})}finally{i(!1)}},handleDeleteNota:async p=>{if(!(!p||typeof p=="string"&&p.startsWith("new_")||!e||!e.id)){i(!0);try{const{error:g}=await G.from("notas_fiscais").delete().match({id:p,user_id:e.id});if(g)throw g;o(l=>l.filter(b=>b.id!==p)),d({title:"Sucesso",description:"Nota fiscal removida."})}catch(g){d({title:"Erro ao Remover Nota",description:g.message,variant:"destructive"})}finally{i(!1)}}},handleFileUploadNF:p=>{const g=p.target.files[0];if(!g||!e)return;const l=new FileReader;l.onload=async b=>{try{const $=new Uint8Array(b.target.result),C=Dr($,{type:"array"}),y=C.SheetNames[0],m=C.Sheets[y],E=Fe.sheet_to_json(m,{header:1});if(E.length<2){d({title:"Erro Planilha",description:"Vazia ou formato inválido.",variant:"destructive"});return}const P=E[0].map(N=>String(N).toLowerCase().trim()),R=["numero_nota","data_nota","cnpj_emitente_nota","codigo_produto_item","descricao_item","quantidade_item","valor_unitario_item"].filter(N=>!P.includes(N));if(R.length>0){d({title:"Erro Cabeçalho",description:`Faltando: ${R.join(", ")}. Use modelo.`,variant:"destructive",duration:7e3});return}const A={};E.slice(1).forEach(N=>{const _=String(N[P.indexOf("numero_nota")]||"");if(!_)return;A[_]||(A[_]={numero_nota:_,data_nota:String(N[P.indexOf("data_nota")]||""),cnpj_emitente:String(N[P.indexOf("cnpj_emitente_nota")]||e.cnpj),items:[],observacoes:String(N[P.indexOf("observacoes_nota")]||""),user_id:e.id,total_calculado:0});const F={id:Date.now()+Math.random(),codigoProduto:String(N[P.indexOf("codigo_produto_item")]||""),descricao:String(N[P.indexOf("descricao_item")]||""),quantidade:parseFloat(String(N[P.indexOf("quantidade_item")]||"0")),valorUnitario:parseFloat(String(N[P.indexOf("valor_unitario_item")]||"0"))};F.valorTotal=(F.quantidade*F.valorUnitario).toFixed(2),A[_].items.push(F)});const U=Object.values(A).map(N=>({...N,total_calculado:N.items.reduce((_,F)=>_+parseFloat(F.valorTotal),0).toFixed(2)}));if(U.length>0){const{error:N}=await G.from("notas_fiscais").insert(U.map(_=>({..._,items:_.items.map(({id:F,...j})=>j)})));if(N)throw N;d({title:"Planilha Carregada",description:`${U.length} notas importadas.`}),s(e)}else d({title:"Nenhuma Nota Importada",description:"Verifique os dados.",variant:"destructive"})}catch($){d({title:"Erro Processar Planilha",description:$.message,variant:"destructive"})}finally{p.target.value=null}},l.readAsArrayBuffer(g)},handleAplicarRendimento:async p=>{const g=t.items[p];if(!g||!g.parte_boi){d({title:"Seleção Inválida",description:"Selecione uma 'Parte do Boi' para aplicar o rendimento.",variant:"destructive"});return}const l=g.parte_boi,b=n.find($=>$.codigo_peca.toLowerCase()===l.toLowerCase());if(!b){d({title:"Parâmetro de rendimento não encontrado",description:H.createElement("div",null,H.createElement("p",null,`Nenhum parâmetro para "${l}".`),H.createElement("p",null,"Use o código ",H.createElement("span",{className:"font-bold text-primary"},l)," para cadastrar."),H.createElement(wr,{to:"/app/parametros",className:"text-sm text-primary underline hover:text-primary/80"},"Ir para Parâmetros de Rendimento")),variant:"destructive",duration:1e4});return}i(!0);try{const{data:$,error:C}=await G.from("desossas_registradas").select("cortes_info, peso_inicial_boi, custo_total_carcaca").eq("user_id",e.id).eq("cnpj_empresa",e.cnpj).order("created_at",{ascending:!1}).limit(10);if(C)throw C;const y=$.filter(N=>N.cortes_info&&N.cortes_info.some(_=>_.parte_boi&&_.parte_boi.toLowerCase()===l.toLowerCase()));if(y.length===0){d({title:"Desossa de Referência não encontrada",description:`Não foi encontrada uma desossa anterior detalhando "${b.descricao_peca}" para usar como base.`,variant:"info",duration:8e3}),i(!1);return}const m={};let E=0;if(y.forEach(N=>{const _=N.cortes_info.filter(F=>F.parte_boi&&F.parte_boi.toLowerCase()===l.toLowerCase());if(_.length>0){E++;const F=_.reduce((j,k)=>j+parseFloat(k.peso||0),0);_.forEach(j=>{const k=j.nome||"Sem Nome";m[k]||(m[k]={codigo_produto:j.codigo_produto||"",nome:k,parte_boi:j.parte_boi,percentualRendimento:0,custoMedio:0,contadorDesossas:0});const I=F>0?parseFloat(j.peso||0)/F*100:0;m[k].percentualRendimento+=I,m[k].custoMedio+=parseFloat(j.novoCustoKg||0),m[k].contadorDesossas++})}}),Object.keys(m).length===0){d({title:"Sem Cortes Detalhados",description:`As desossas de referência não possuem cortes específicos para "${b.descricao_peca}".`,variant:"info",duration:7e3}),i(!1);return}const P=Object.values(m).map(N=>({...N,percentualRendimentoMedio:N.percentualRendimento/N.contadorDesossas,custoMedio:N.custoMedio/N.contadorDesossas})),S=parseFloat(t.total_calculado||0),R=P.map(N=>{const _=parseFloat(g.quantidade||0)*(N.percentualRendimentoMedio/100),F=P.reduce((Y,Z)=>Y+Z.percentualRendimentoMedio,0),j=F>0?N.percentualRendimentoMedio/F*100:0,k=S>0?j/100*S:N.custoMedio,I=_>0?k/_:N.custoMedio;return{id:Date.now()+Math.random(),codigoProduto:N.codigo_produto||`AUT-${b.codigo_peca}-${Math.random().toString(36).substr(2,5).toUpperCase()}`,descricao:N.nome,quantidade:_.toFixed(3),valorUnitario:I.toFixed(2),valorTotal:k.toFixed(2),parte_boi:N.parte_boi}}),A=[...t.items];A.splice(p,1,...R);const U=A.reduce((N,_)=>N+parseFloat(_.valorTotal||0),0);a(N=>({...N,items:A,total_calculado:U.toFixed(2)})),d({title:"Rendimento Aplicado com Sucesso",description:`Item foi detalhado em ${R.length} cortes baseado na média de ${E} desossa(s). Custos calculados proporcionalmente.`})}catch($){d({title:"Erro ao Aplicar Rendimento",description:$.message,variant:"destructive"})}finally{i(!1)}}}),Es=()=>{const{toast:e}=ft(),{currentUser:t,notas:n,setNotas:o,loading:a,parametrosRendimento:c,produtosInventario:i,produtosDesossa:s,fetchInitialData:d}=$s(),[u,h]=r.useState(!1),[v,x]=r.useState(null),[p,g]=r.useState(""),[l,b]=r.useState(!1),$=r.useCallback(()=>({id:null,numero_nota:"",data_nota:"",cnpj_emitente:(t==null?void 0:t.cnpj)||"",items:[{id:Date.now(),codigoProduto:"",descricao:"",quantidade:"",valorUnitario:"",valorTotal:"",parte_boi:""}],total_calculado:0,observacoes:"",user_id:(t==null?void 0:t.id)||null}),[t]),{handleSaveNota:C,handleDeleteNota:y,handleFileUploadNF:m,handleAplicarRendimento:E}=gs({currentUser:t,currentNota:v,parametrosRendimento:c,setNotas:o,setCurrentNota:x,setModalOpen:h,setIsSaving:b,fetchInitialData:d,toast:e});r.useEffect(()=>{t&&u&&(v==null?void 0:v.id)===null&&x(_=>({..._,cnpj_emitente:t.cnpj,user_id:t.id}))},[t,u,v]);const P=(_=null)=>{if(_)x({..._,items:_.items.map((F,j)=>({...F,id:Date.now()+j+Math.random()}))});else{const F=$();x({...F,id:`new_${Date.now()}`})}h(!0)},S=(_,F)=>x(j=>({...j,[_]:F})),R=(_,F)=>{const j=[...v.items],k={...j[_],...F};j[_]=k,(F.quantidade||F.valorUnitario)&&k.quantidade&&k.valorUnitario&&(k.valorTotal=(parseFloat(k.quantidade)*parseFloat(k.valorUnitario)).toFixed(2));const I=j.reduce((Y,Z)=>Y+parseFloat(Z.valorTotal||0),0);x(Y=>({...Y,items:j,total_calculado:I.toFixed(2)}))},A=()=>x(_=>({..._,items:[..._.items,{id:Date.now(),codigoProduto:"",descricao:"",quantidade:"",valorUnitario:"",valorTotal:"",parte_boi:""}]})),U=_=>{const F=v.items.filter((k,I)=>I!==_),j=F.reduce((k,I)=>k+parseFloat(I.valorTotal||0),0);x(k=>({...k,items:F,total_calculado:j.toFixed(2)}))},N=n.filter(_=>{var F,j;return((F=_.numero_nota)==null?void 0:F.toLowerCase().includes(p.toLowerCase()))||((j=_.data_nota)==null?void 0:j.includes(p))||_.items&&_.items.some(k=>{var I;return(I=k.descricao)==null?void 0:I.toLowerCase().includes(p.toLowerCase())})});return{currentUser:t,notas:n,modalOpen:u,currentNota:v,searchTerm:p,loading:a,isSaving:l,parametrosRendimento:c,produtosInventario:i,produtosDesossa:s,filteredNotas:N,setModalOpen:h,setCurrentNota:x,setSearchTerm:g,handleOpenModal:P,handleNotaChange:S,handleItemChange:R,handleAddItem:A,handleRemoveItem:U,handleSaveNota:C,handleDeleteNota:y,handleFileUploadNF:m,handleAplicarRendimento:E,initialNotaState:$}},Bs=()=>{const{currentUser:e,modalOpen:t,currentNota:n,searchTerm:o,loading:a,isSaving:c,produtosInventario:i,produtosDesossa:s,desossasRegistradas:d,filteredNotas:u,setModalOpen:h,setSearchTerm:v,handleOpenModal:x,handleNotaChange:p,handleItemChange:g,handleAddItem:l,handleRemoveItem:b,handleSaveNota:$,handleDeleteNota:C,handleFileUploadNF:y,handleAplicarRendimento:m}=Es(),{toast:E}=ft(),P=()=>{const S=[["numero_nota","data_nota","cnpj_emitente_nota","codigo_produto_item","descricao_item","quantidade_item","valor_unitario_item","observacoes_nota"],["12345","2025-06-10","00.000.000/0001-00","P001","DIANTEIRO BOVINO","150.5","20.50","Compra gado"]],R=Fe.aoa_to_sheet(S),A=Fe.book_new();Fe.book_append_sheet(A,R,"ModeloNotasFiscais"),Or(A,`Modelo_Notas_Fiscais_${Sr}.xlsx`),E({title:"Download Iniciado",description:"Modelo de planilha baixado."})};return a?f.jsxs("div",{className:"flex justify-center items-center h-64",children:[f.jsx(et,{size:48}),f.jsx("p",{className:"ml-3",children:"Carregando..."})]}):!e&&!a?f.jsx("div",{className:"text-center py-10",children:f.jsx("p",{className:"text-red-500",children:"Erro ao carregar usuário."})}):f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[f.jsx("h1",{className:"text-3xl font-bold",children:"Gerenciamento de Notas Fiscais"}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[f.jsx(K,{type:"search",placeholder:"Pesquisar por nº, data ou item...",value:o,onChange:S=>v(S.target.value),className:"max-w-xs"}),f.jsxs(V,{onClick:()=>x(),className:"whitespace-nowrap",children:[f.jsx(pn,{className:"mr-2 h-4 w-4"})," Adicionar Manual"]})]})]}),f.jsxs(Ue,{className:"glass-card",children:[f.jsx(gt,{children:f.jsx(Et,{children:"Importar Notas de Planilha"})}),f.jsxs(Be,{className:"flex flex-col sm:flex-row gap-4 items-center",children:[f.jsxs(V,{onClick:P,variant:"outline",className:"w-full sm:w-auto",children:[f.jsx(Ar,{className:"mr-2 h-4 w-4"})," Baixar Modelo"]}),f.jsxs("div",{className:"w-full sm:w-auto",children:[f.jsx(W,{htmlFor:"uploadPlanilhaNF",className:"sr-only",children:"Carregar"}),f.jsx(K,{id:"uploadPlanilhaNF",type:"file",accept:".xlsx, .xls",onChange:y,className:"w-full"})]})]}),f.jsx(xt,{children:f.jsx("p",{className:"text-xs text-muted-foreground",children:'Use o modelo. Linhas com mesmo "numero_nota" serão agrupadas.'})})]}),u.length===0&&!a?f.jsx(Ue,{className:"glass-card text-center py-12",children:f.jsxs(Be,{children:[f.jsx(Fr,{className:"mx-auto h-16 w-16 text-muted-foreground mb-4"}),f.jsx("p",{className:"text-xl text-muted-foreground",children:"Nenhuma nota fiscal encontrada."}),o&&f.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Tente um termo de busca diferente."})]})}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(S=>f.jsx(Cr.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},children:f.jsxs(Ue,{className:"glass-card h-full flex flex-col",children:[f.jsxs(gt,{children:[f.jsxs(Et,{children:["NF-e: ",S.numero_nota]}),f.jsxs(Pr,{children:["Data: ",S.data_nota?new Date(S.data_nota+"T00:00:00").toLocaleDateString("pt-BR"):"N/A"," | CNPJ: ",S.cnpj_emitente]})]}),f.jsxs(Be,{className:"flex-grow",children:[f.jsxs("p",{className:"font-semibold",children:["Itens (",S.items?S.items.length:0,"):"]}),f.jsxs("ul",{className:"list-disc list-inside text-sm text-muted-foreground max-h-24 overflow-y-auto",children:[S.items&&S.items.slice(0,3).map((R,A)=>f.jsxs("li",{children:[R.descricao," (",R.quantidade,")"]},A)),S.items&&S.items.length>3&&f.jsxs("li",{children:["... e mais ",S.items.length-3]})]}),f.jsxs("p",{className:"mt-2 font-bold text-lg",children:["Total: ",f.jsx("span",{className:"text-primary",children:parseFloat(S.total_calculado||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]})]}),f.jsxs(xt,{className:"flex justify-end gap-2",children:[S.link_pdf&&f.jsx(V,{asChild:!0,variant:"secondary",size:"sm",children:f.jsxs("a",{href:S.link_pdf,target:"_blank",rel:"noopener noreferrer",children:[f.jsx(jr,{className:"mr-1 h-3 w-3"})," Ver PDF"]})}),f.jsxs(V,{variant:"outline",size:"sm",onClick:()=>x(S),disabled:c,children:[f.jsx(Tr,{className:"mr-1 h-3 w-3"})," Editar"]}),f.jsxs(V,{variant:"destructive",size:"sm",onClick:()=>C(S.id),disabled:c,children:[c&&(n==null?void 0:n.id)===S.id?f.jsx(et,{size:12,className:"mr-1"}):f.jsx(vn,{className:"mr-1 h-3 w-3"}),"Excluir"]})]})]})},S.id))}),t&&f.jsx(bs,{open:t,setOpen:h,currentNota:n,handleNotaChange:p,handleItemChange:g,handleAddItem:l,handleRemoveItem:b,handleSaveNota:$,isSaving:c,handleAplicarRendimento:m,produtosInventario:i,produtosDesossa:s,desossasRegistradas:d})]})};export{Bs as default};
